import pytest

from vulnerability_scanner import WebVulnerabilityScanner


@pytest.mark.asyncio
async def test_http_usage_finding_present_for_http_url():
    s = WebVulnerabilityScanner()
    findings = await s._check_https_usage('http://plain.test/')
    assert any(f.vulnerability_type == 'http_usage' for f in findings)


