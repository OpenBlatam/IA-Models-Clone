import pytest

hypothesis = pytest.importorskip("hypothesis")
from hypothesis import given, strategies as st

from vulnerability_scanner import WebVulnerabilityScanner


@given(payload=st.sampled_from([
    "<script>alert(1)</script>",
    "javascript:alert(1)",
    "onload=alert(1)",
    "../../etc/passwd",
    "..\\..\\windows\\system32",
    "UNION SELECT 1 --",
]))
@pytest.mark.asyncio
async def test_content_patterns_detect_various(payload):
    scanner = WebVulnerabilityScanner()
    findings = await scanner._scan_content_patterns("http://t", payload)  # type: ignore
    assert len(findings) >= 1













