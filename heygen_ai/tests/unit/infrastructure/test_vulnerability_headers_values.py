import pytest

from vulnerability_scanner import WebVulnerabilityScanner


@pytest.mark.asyncio
async def test_security_headers_weak_and_missing():
    scanner = WebVulnerabilityScanner()
    headers = {
        "X-Frame-Options": "ALLOW-FROM *",
        # Missing X-Content-Type-Options
        "Strict-Transport-Security": "max-age=0",  # weak
        # Missing CSP
    }
    findings = await scanner._check_security_headers("https://ex", headers)  # type: ignore
    types = [f.vulnerability_type for f in findings]
    assert "weak_security_header" in types or "missing_security_header" in types













